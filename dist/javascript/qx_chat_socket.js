function changeNickname(e){socket.emit("change_nickname",e)}function say(e){socket.emit("say",e)}var chat_server="http://"+location.hostname+":8888";console.log("server: "+chat_server);var socket=io.connect(chat_server);socket.on("need_nickname",function(){$.cookie("chat_nickname")?changeNickname($.cookie("chat_nickname")):$("#login-modal").modal("show")}),socket.on("server_message",function(e){addServerMessage(getLocalHMS(),e)}),socket.on("change_nickname_error",function(e){console.log("change_nickname_error : "+e),$("#login-modal").modal("show"),$("#nickname-error").text(e),$("#nickname-error").show(),$("#nickname-edit").focus()}),socket.on("change_nickname_done",function(e,t){console.log("change_nickname_done("+t+","+e+")"),$.cookie("chat_nickname",t),$("#login-modal").modal("hide"),$("#my-nickname").html("昵称："+t),e!==null&&e!==""&&addServerMessage(getLocalHMS(),"["+e+"] 改名为 ["+t+"]"),updateListCount()}),socket.on("say_done",function(e,t){console.log("user_say("+e+", "+t+")"),addMessage(e,getLocalHMS(),t)}),socket.on("user_list",function(e){useUserList(e)}),socket.on("user_change_nickname",function(e,t){console.log("user_change_nickname("+e+", "+t+")"),removeListUser(e),addUserToList(t),addServerMessage(getLocalHMS(),"["+e+"] 改名为 ["+t+"]")}),socket.on("user_join",function(e){console.log("user_join("+e+")"),addUserToList(e),updateListCount(),addServerMessage(getLocalHMS(),"["+e+"] 进入了聊天室。")}),socket.on("user_quit",function(e){console.log("user_quit("+e+")"),removeListUser(e),updateListCount(),addServerMessage(getLocalHMS(),"["+e+"] 离开了聊天室。")}),socket.on("user_say",function(e,t){console.log("user_say("+e+", "+t+")"),addMessage(e,getLocalHMS(),t),"hidden"==document[GetVisibilityKey()]&&Notify.show({icon:"/img/qx_chat.png",title:"千寻聊天室",message:e+"："+t,autoclose:3,onclick:function(){window.focus(),undefined!==typeof this.colse?this.close():undefined!==typeof this.cancel&&this.cancel()}})});