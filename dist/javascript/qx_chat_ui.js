"use strict";function chatBodyToBottom(){var n=$(".chat-body"),s=n.prop("scrollHeight");n.prop("scrollTop",s)}function addMessage(n,s,i){var t=$(".msg-list-body");i=QxEmotion.Parse(i),t.append('<div class="clearfix msg-wrap"><div class="msg-head"><span class="msg-name label label-primary pull-left"><span class="glyphicon glyphicon-user"></span>&nbsp;&nbsp;'+n+'</span><span class="msg-time label label-default pull-left"><span class="glyphicon glyphicon-time"></span>&nbsp;&nbsp;'+s+'</span></div><div class="msg-content">'+i+"</div></div>"),chatBodyToBottom()}function addServerMessage(n,s){var i=$(".msg-list-body");s=QxEmotion.Parse(s),i.append('<div class="clearfix msg-wrap"><div class="msg-head"><span class="msg-name label label-danger pull-left"><span class="glyphicon glyphicon-info-sign"></span>&nbsp;&nbsp;系统消息</span><span class="msg-time label label-default pull-left"><span class="glyphicon glyphicon-time"></span>&nbsp;&nbsp;'+n+'</span></div><div class="msg-content">'+s+"</div></div>"),chatBodyToBottom()}function removeListUser(n){$(".list-table tr").each(function(){n==$(this).find("td").text()&&$(this).remove()})}function addUserToList(n){$(".list-table").append("<tr><td>"+n+"</td></tr>")}function useUserList(n){$(".list-table").html("");var s;for(s=0;s<n.length;s++)addUserToList(n[s]);updateListCount()}function updateListCount(){var n=$(".list-table").find("tr").length+1;$("#list-count").text("当前在线："+n+"人")}function onClickSendMessage(){if(!$.cookie("chat_nickname"))return void $("#login-modal").modal("show");var n=$("#input-edit"),s=n.val();""!==s&&(say(s),n.val(""))}function onClickApplyNickname(){var n=$("#nickname-edit"),s=$("#nickname-error"),i=n.val();if(""===i)return s.text("请填写昵称。"),s.show(),void n.focus();var t=getStringLength(i);return 4>t||t>16?(s.text("请填写正确的昵称，应为4到16个字符。"),void s.show()):(i==$.cookie("chat_nickname")&&(s.text("你本来就叫这个。"),s.show()),changeNickname(i),void Notify.request())}function onClickChangeNickname(){$("#login-modal").modal("show")}var g_hide=!1;$("div[role='dialog']").on("show.bs.modal",function(){$(this).css({display:"block","margin-top":function(){return $(this).height()/3}})}),$("#login-modal").on("show.bs.modal",function(){$("#nickname-edit").val(""),$("#nickname-error").hide()}),$("#login-modal").on("shown.bs.modal",function(){$("#nickname-edit").focus()}),$("#input-edit").keydown(function(n){13===n.keyCode&&onClickSendMessage()}),$("#nickname-edit").keydown(function(n){13===n.keyCode&&onClickApplyNickname()}),QxEmotion($("#emotion-btn"),$("#input-edit"));