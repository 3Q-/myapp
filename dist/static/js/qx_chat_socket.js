"use strict";function changeNickname(a){socket.emit("change_nickname",a)}function say(a){socket.emit("say",a)}var chat_server="http://"+location.hostname+":8888";console.log("server: "+chat_server);var socket=io.connect(chat_server);socket.on("need_nickname",function(){$.cookie("chat_nickname")?changeNickname($.cookie("chat_nickname")):$("#login-modal").modal("show")}),socket.on("server_message",function(a){addServerMessage(getLocalHMS(),a)}),socket.on("change_nickname_error",function(a){console.log("change_nickname_error : "+a),$("#login-modal").modal("show"),$("#nickname-error").text(a),$("#nickname-error").show(),$("#nickname-edit").focus()}),socket.on("change_nickname_done",function(a,b){console.log("change_nickname_done("+b+","+a+")"),$.cookie("chat_nickname",b),$("#login-modal").modal("hide"),$("#my-nickname").html("昵称："+b),null!==a&&""!==a&&addServerMessage(getLocalHMS(),"["+a+"] 改名为 ["+b+"]"),updateListCount()}),socket.on("say_done",function(a,b){console.log("user_say("+a+", "+b+")"),addMessage(a,getLocalHMS(),b)}),socket.on("user_list",function(a){useUserList(a)}),socket.on("user_change_nickname",function(a,b){console.log("user_change_nickname("+a+", "+b+")"),removeListUser(a),addUserToList(b),addServerMessage(getLocalHMS(),"["+a+"] 改名为 ["+b+"]")}),socket.on("user_join",function(a){console.log("user_join("+a+")"),addUserToList(a),updateListCount(),addServerMessage(getLocalHMS(),"["+a+"] 进入了聊天室。")}),socket.on("user_quit",function(a){console.log("user_quit("+a+")"),removeListUser(a),updateListCount(),addServerMessage(getLocalHMS(),"["+a+"] 离开了聊天室。")}),socket.on("user_say",function(a,b){console.log("user_say("+a+", "+b+")"),addMessage(a,getLocalHMS(),b),"hidden"==document[GetVisibilityKey()]&&Notify.show({icon:"/img/qx_chat.png",title:"千寻聊天室",message:a+"："+b,autoclose:3,onclick:function(){window.focus(),void 0!==typeof this.colse?this.close():void 0!==typeof this.cancel&&this.cancel()}})});