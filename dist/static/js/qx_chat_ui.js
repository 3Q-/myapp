"use strict";function chatBodyToBottom(){var a=$(".chat-body"),b=a.prop("scrollHeight");a.prop("scrollTop",b)}function addMessage(a,b,c){var d=$(".msg-list-body");c=QxEmotion.Parse(c),d.append('<div class="clearfix msg-wrap"><div class="msg-head"><span class="msg-name label label-primary pull-left"><span class="glyphicon glyphicon-user"></span>&nbsp;&nbsp;'+a+'</span><span class="msg-time label label-default pull-left"><span class="glyphicon glyphicon-time"></span>&nbsp;&nbsp;'+b+'</span></div><div class="msg-content">'+c+"</div></div>"),chatBodyToBottom()}function addServerMessage(a,b){var c=$(".msg-list-body");b=QxEmotion.Parse(b),c.append('<div class="clearfix msg-wrap"><div class="msg-head"><span class="msg-name label label-danger pull-left"><span class="glyphicon glyphicon-info-sign"></span>&nbsp;&nbsp;系统消息</span><span class="msg-time label label-default pull-left"><span class="glyphicon glyphicon-time"></span>&nbsp;&nbsp;'+a+'</span></div><div class="msg-content">'+b+"</div></div>"),chatBodyToBottom()}function removeListUser(a){$(".list-table tr").each(function(){a==$(this).find("td").text()&&$(this).remove()})}function addUserToList(a){$(".list-table").append("<tr><td>"+a+"</td></tr>")}function useUserList(a){$(".list-table").html("");var b;for(b=0;b<a.length;b++)addUserToList(a[b]);updateListCount()}function updateListCount(){var a=$(".list-table").find("tr").length+1;$("#list-count").text("当前在线："+a+"人")}function onClickSendMessage(){if(!$.cookie("chat_nickname"))return void $("#login-modal").modal("show");var a=$("#input-edit"),b=a.val();""!==b&&(say(b),a.val(""))}function onClickApplyNickname(){var a=$("#nickname-edit"),b=$("#nickname-error"),c=a.val();if(""===c)return b.text("请填写昵称。"),b.show(),void a.focus();var d=getStringLength(c);return 4>d||d>16?(b.text("请填写正确的昵称，应为4到16个字符。"),void b.show()):(c==$.cookie("chat_nickname")&&(b.text("你本来就叫这个。"),b.show()),changeNickname(c),void Notify.request())}function onClickChangeNickname(){$("#login-modal").modal("show")}var g_hide=!1;$("div[role='dialog']").on("show.bs.modal",function(){$(this).css({display:"block","margin-top":function(){return $(this).height()/3}})}),$("#login-modal").on("show.bs.modal",function(){$("#nickname-edit").val(""),$("#nickname-error").hide()}),$("#login-modal").on("shown.bs.modal",function(){$("#nickname-edit").focus()}),$("#input-edit").keydown(function(a){13===a.keyCode&&onClickSendMessage()}),$("#nickname-edit").keydown(function(a){13===a.keyCode&&onClickApplyNickname()}),QxEmotion($("#emotion-btn"),$("#input-edit"));